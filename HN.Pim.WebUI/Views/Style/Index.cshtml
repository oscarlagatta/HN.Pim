@using HN.Pim.WebUI.Models
@model StyleModel
@{
    ViewBag.Title = "Styles";
}

<style>
    .pagination {
        margin-top: -1em;
    }
</style>

@using (Html.BeginForm())
{
  <!-- BEGIN HIDDEN FIELDS AREA -->
    @Html.HiddenFor(m => m.EventCommand)
    @Html.HiddenFor(m => m.EventArgument)
    @Html.HiddenFor(m => m.Pager.PageIndex)
    @Html.HiddenFor(m => m.LastSortExpression)
    @Html.HiddenFor(m => m.SortExpression)
    @Html.HiddenFor(m => m.SortDirection)
    @Html.HiddenFor(m => m.SortDirectionNew)
    @Html.HiddenFor(m => m.QuantityOfPages,  new { @Id = "hn-pages" })
  <!-- END HIDDEN FIELDS AREA -->

    <div class="row">
        <div class="col-md-12">
            <div class="table-responsive">
                <table class="table table-condensed table-bordered table-striped table-hover">
                    <thead>
                        <tr>
                            <th>
                                <a href="#"
                                   data-hn-action="sort"
                                   data-hn-val="MerretStyleID"
                                   data-hn-direction="Ascending">
                                    Style Id
                                </a>
                            </th>
                            <th>
                                <a href="#"
                                   data-hn-action="sort"
                                   data-hn-val="MerretDescription"
                                   data-hn-direction="Ascending">
                                    Description
                                </a>
                            </th>
                            <th>
                                <a href="#"
                                   data-hn-action="sort"
                                   data-hn-val="ShortWebDescription"
                                   data-hn-direction="Descending">
                                    Web Description
                                </a>
                            </th>
                            <th>
                                <a href="#"
                                   data-hn-action="sort"
                                   data-hn-val="MinPrice"
                                   data-hn-direction="Ascending">
                                    Min Price
                                </a>
                            </th>
                            <th>
                                <a href="#"
                                   data-hn-action="sort"
                                   data-hn-val="MaxPrice"
                                   data-hn-direction="Ascending">
                                    Max Price
                                </a>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Styles)
                        {
                            <tr>
                                <td>
                                    @item.MerretStyleID
                                </td>
                                <td>
                                    @item.MerretDescription
                                </td>
                                <td>
                                    @item.ShortWebDescription
                                </td>
                                <td>
                                    @if (item.MinPrice.HasValue)
                                    {@item.MinPrice.Value.ToString("c")
                                    }
                                </td>
                                <td>
                                    @if (item.MaxPrice.HasValue)
                                    {@item.MaxPrice.Value.ToString("c")
                                    }
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            @if (Model.IsPagerVisible)
            {
                <ul id="pagination-demo" class="pagination pagination-sm">
                    @foreach (PagerItem item in Model.Pages)
                    {
                        <li class="@item.CssClass">
                            <a href="#"
                               data-hn-action="page"
                               data-hn-val="@item.Argument"
                               title="@item.Tooltip">
                                @Html.Raw(item.Text)
                            </a>
                        </li>
                    }
                </ul>
            }
        </div>
    </div>

}


@section scripts {

    <script>
        $("[data-hn-action]").on("click", function (e) {
            e.preventDefault();

            //// Fill in hidden fields with action and argument to post back to model
            //$("#EventCommand").val($(this).attr("data-hn-action"));
            //$("#EventArgument").val($(this).attr("data-hn-val"));

            //// Use the switch statement to get and set any special parameters
            //switch ($("#EventCommand").val()) {
            //    case "sort":
            //        // Store the last sort expression
            //        $("#LastSortExpression").val($("#SortExpression").val());
            //        // Get the new sort expression
            //        $("#SortExpression").val($(this).data("hn-val"));
            //        // Set the new sort direction
            //        $("#SortDirectionNew").val($(this).data("hn-direction"));
            //        break;
            //}

            //// Submit form with hidden values filled in
            //$("form").submit();
        });

       
        $('#pagination-demo').twbsPagination({
            totalPages: $("#hn-pages").val(),
            visiblePages: 28,
            onPageClick: function (event, page) {
                debugger;
                // Fill in hidden fields with action and argument to post back to model
                $("#EventCommand").val($(this).attr("data-hn-action"));
                $("#EventArgument").val($(this).attr("data-hn-val"));

                // Use the switch statement to get and set any special parameters
                switch ($("#EventCommand").val()) {
                    case "sort":
                        // Store the last sort expression
                        $("#LastSortExpression").val($("#SortExpression").val());
                        // Get the new sort expression
                        $("#SortExpression").val($(this).data("hn-val"));
                        // Set the new sort direction
                        $("#SortDirectionNew").val($(this).data("hn-direction"));
                        break;
                }

                // Submit form with hidden values filled in
                $("form").submit();
            }
        });
    </script>
}